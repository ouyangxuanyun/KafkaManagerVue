<!DOCTYPE html>
<html>
<head>
  <title>Topic List</title>
  <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
  <link rel='stylesheet' href='/bootstrap-3.3.5/css/bootstrap.min.css'>

  <link rel="stylesheet" media="screen" href="/stylesheets/index.min.css">
  <link rel="stylesheet" media="screen" href="/dataTables/stylesheets/dataTables.bootstrap.css">
  <link rel="stylesheet" media="screen" href="/chartist/stylesheets/chartist.min.css">
  <!--
  <script data-main="/vassets/javascripts/index.js" src="/webjars/requirejs/2.1.20/require.min.js"></script>
  -->
  <script src="/chartist/javascripts/chartist.min.js"></script>

  <script src="/jquery-2.1.4/jquery.min.js"></script>
  <script src="/bootstrap-3.3.5/js/bootstrap.min.js"></script>
  <script src="/dataTables/javascripts/jquery.dataTables.min.js"></script>
  <script src="/dataTables/javascripts/dataTables.bootstrap.js"></script>

  <script src="/javascripts/vue.js"></script>
</head>
<body role="document">

<div id="vueTemp">
  <div class="navbar navbar-default" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <!--  Display three horizontal lines when navbar collapsed. -->
          <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span>
        </button>
        <img src="/images/favicon.png">
        <a class="navbar-brand un-float-me" v-bind:href="'/'">
          Kafka Manager</a>
        <template><span class="label label-primary">{{clusters}}</span></template>
      </div>

      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cluster<span
              class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
              <li><a v-bind:href="'/addCluster'">Add Cluster</a></li>
              <li><a v-bind:href="'/clusters/'+clusters">Summary</a></li>
              <li><a v-bind:href="'/'">List</a></li>
            </ul>
          </li>

          <li><a v-bind:href="'/clusters/'+clusters+'/brokers'">Brokers</a></li>
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Topic<span class="caret"></span></a>
            <ul class="dropdown-menu" role="menu">
              <li><a v-bind:href="'/clusters/'+clusters+'/createTopic'">Create</a></li>
              <li class="active"><a v-bind:href="'/clusters/'+clusters+'/topics'">List</a></li>
            </ul>
          </li>
          <li><a v-bind:href="'/clusters/'+clusters+'/consumers'">Consumers</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container" role="main">
    <ol class="breadcrumb">
      <li><a v-bind:href="'/'">Clusters</a></li>
      <li>
        <template><a v-bind:href="'/clusters/'+clusters">{{clusters}}</a></template>
      </li>
      <li class="active">Topics</li>
    </ol>

    <div class="col-md-12">
      <div class="panel panel-default">
        <div class="panel-heading"><h3>Topics</h3></div>
        <table class="table" id="topics-table">
          <thead>
          <tr>
            <th>Topic</th>
            <th># Partitions</th>
            <th># Brokers</th>
            <th>Brokers Spread %</th>
            <th>Brokers Skew %</th>
            <th># Replicas</th>
            <th>Under Replicated %</th>
            <th>Producer Message/Sec</th>
            <th>Summed Recent Offsets</th>
            <th>Leader Size</th>
          </tr>
          </thead>
          <tbody>
          <!--Dynamic data-->

          <template v-for="topic in topicList">
            <tr class="">
              <td class=""><a v-bind:href="'/clusters/'+clusters+'/topics/'+topic.name">{{topic.name}}</a>
              </td>
              <td>{{topic.partitions}}</td>
              <td>{{topic.t_brokers}}</td>
              <td v-bind:class="topic.b_spr_class">{{topic.brokerSpread}}</td>
              <td v-bind:class="topic.b_skw_class">{{topic.brokerSkewed}}</td>
              <td>{{topic.replicas}}</td>
              <td v-bind:class="topic.u_rpl_class">{{topic.unserReplicated}}</td>
              <td>{{topic.producerMsg.toFixed(2)}}</td>
              <td>{{topic.offset}}</td>
              <td>{{topic.leaderSize}}</td>
            </tr>
          </template>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<script>
  function goBack() {
    window.history.back()
  }

  function checkBoxSelect(idPrefix, booleanValue, display) {
    $("[id^=" + idPrefix + "]").prop("checked", booleanValue);
  }

  function selectBySubname(selectId, selectClass, display) {
    var subname = $(selectId).val().toLowerCase();
    $('.' + selectClass).not("[name*='" + subname + "']").css("display", "none");
    $("[class='" + selectClass + "'][name*='" + subname + "']").css("display", display);
    if (subname == "") {
      $('.' + selectClass).css("display", display);
    }
  }

  function disableSubmission() {
    $('[type=submit]').prop('disabled', true);
    $('[type=submit]').removeAttr('type');
  }

  $.ajax({
    url: "/getTopicList",
    //data: {},
    success: function (result) {
      //alert(result.topicList[0].name)
      new Vue({
        el: '#vueTemp',
        data: {
          clusters: result.clusters,
          topicList: result.topicList
        }
      })
    },
    error: function (error) {
    }
  });

</script>

<script type="text/javascript">
  $(document).ready(function () {
    setTimeout(function () {
      $('#topics-table').DataTable();
    }, 5000)
  });
</script>
</body>
</html>
